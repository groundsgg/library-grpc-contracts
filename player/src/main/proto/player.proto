syntax = "proto3";

package gg.grounds.grpc.player;

option java_multiple_files = true;
option java_package = "gg.grounds.grpc.player";
option java_outer_classname = "PlayerProto";

service PlayerPresenceService {
  rpc TryPlayerLogin (PlayerLoginRequest) returns (PlayerLoginReply);
  rpc PlayerLogout (PlayerLogoutRequest) returns (PlayerLogoutReply);
  rpc PlayerHeartbeatBatch (PlayerHeartbeatBatchRequest) returns (PlayerHeartbeatBatchReply);
}

message PlayerLoginRequest {
  string player_id = 1;
}

message PlayerLoginReply {
  LoginStatus status = 1;
  string message = 2;
}

message PlayerLogoutRequest {
  string player_id = 1;
}

message PlayerLogoutReply {
  bool removed = 1;
  string message = 2;
}

message PlayerHeartbeatBatchRequest {
  repeated string player_ids = 1;
}

message PlayerHeartbeatBatchReply {
  int32 updated = 1;
  int32 missing = 2;
  string message = 3;
  // success is true when the request is valid and processed; false for invalid requests or server errors.
  bool success = 4;
}

enum LoginStatus {
  LOGIN_STATUS_UNSPECIFIED = 0;
  LOGIN_STATUS_ACCEPTED = 1;
  LOGIN_STATUS_ALREADY_ONLINE = 2;
  LOGIN_STATUS_INVALID_REQUEST = 3;
  LOGIN_STATUS_ERROR = 4;
}
